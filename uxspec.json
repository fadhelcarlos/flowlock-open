{
  "version": "1.0.0",
  "name": "Demo spec with gaps (triggers heal + agent fix)",
  "entities": [
    {
      "id": "user",
      "name": "User",
      "fields": [
        {
          "id": "id",
          "name": "ID",
          "type": "string",
          "required": true,
          "derived": true,
          "provenance": "system.uuid"
        },
        {
          "id": "email",
          "name": "Email",
          "type": "email",
          "required": true
        },
        {
          "id": "name",
          "name": "Name",
          "type": "string",
          "required": true
        },
        {
          "id": "role",
          "name": "Role",
          "type": "string"
        },
        {
          "id": "createdAt",
          "name": "Created At",
          "type": "date",
          "derived": true,
          "provenance": "system.timestamp"
        }
      ]
    },
    {
      "id": "product",
      "name": "Product",
      "fields": [
        {
          "id": "id",
          "name": "ID",
          "type": "string",
          "required": true,
          "external": true,
          "source": "catalog_api"
        },
        {
          "id": "name",
          "name": "Name",
          "type": "string",
          "required": true,
          "external": true,
          "source": "catalog_api"
        },
        {
          "id": "description",
          "name": "Description",
          "type": "text",
          "external": true,
          "source": "catalog_api"
        },
        {
          "id": "price",
          "name": "Price",
          "type": "number",
          "required": true,
          "external": true,
          "source": "catalog_api"
        },
        {
          "id": "stock",
          "name": "Stock",
          "type": "number",
          "external": true,
          "source": "catalog_api"
        }
      ]
    }
  ],
  "screens": [
    {
      "id": "user_list",
      "name": "User List",
      "type": "list",
      "entityId": "user",
      "reads": [
        "user.id",
        "user.name",
        "user.email",
        "user.role"
      ],
      "roles": [
        "admin",
        "viewer"
      ],
      "uiStates": [
        "empty",
        "loading",
        "error"
      ]
    },
    {
      "id": "user_detail",
      "name": "User Detail",
      "entityId": "user",
      "reads": [
        "user.id",
        "user.name",
        "user.email",
        "user.role",
        "user.createdAt"
      ],
      "type": "detail",
      "roles": [
        "admin",
        "viewer"
      ],
      "uiStates": [
        "empty",
        "loading",
        "error"
      ]
    },
    {
      "id": "user_create",
      "name": "Create User",
      "type": "form",
      "entityId": "user",
      "forms": [
        {
          "id": "create_user_form",
          "entityId": "user",
          "type": "create",
          "fields": [
            {
              "fieldId": "email",
              "label": "Email Address"
            },
            {
              "fieldId": "name",
              "label": "Full Name"
            },
            {
              "fieldId": "role",
              "label": "User Role"
            }
          ]
        }
      ],
      "roles": [
        "admin",
        "viewer"
      ],
      "uiStates": [
        "empty",
        "loading",
        "error"
      ]
    },
    {
      "id": "user_created",
      "name": "User Created",
      "type": "success",
      "roles": [
        "admin",
        "viewer"
      ],
      "uiStates": [
        "empty",
        "loading",
        "error"
      ]
    },
    {
      "id": "product_list",
      "name": "Product Catalog",
      "type": "list",
      "entityId": "product",
      "reads": [
        "product.id",
        "product.name",
        "product.price",
        "product.stock"
      ],
      "roles": [
        "admin",
        "viewer"
      ],
      "uiStates": [
        "empty",
        "loading",
        "error"
      ]
    },
    {
      "id": "product_detail",
      "name": "Product Detail",
      "entityId": "product",
      "reads": [
        "product.id",
        "product.name",
        "product.description",
        "product.price",
        "product.stock"
      ],
      "type": "detail",
      "roles": [
        "admin",
        "viewer"
      ],
      "uiStates": [
        "empty",
        "loading",
        "error"
      ]
    }
  ],
  "flows": [
    {
      "id": "create_user_flow",
      "name": "Create User Flow",
      "entryStepId": "cu_1",
      "steps": [
        {
          "id": "cu_1",
          "screenId": "user_list",
          "next": [
            {
              "targetStepId": "cu_2"
            }
          ]
        },
        {
          "id": "cu_2",
          "screenId": "user_create",
          "next": [
            {
              "targetStepId": "cu_3"
            }
          ]
        },
        {
          "id": "cu_3",
          "screenId": "user_created",
          "next": [
            {
              "targetStepId": "cu_4"
            }
          ]
        },
        {
          "id": "cu_4",
          "screenId": "user_detail"
        }
      ]
    },
    {
      "id": "browse_products_flow",
      "name": "Browse Products",
      "entryStepId": "bp_1",
      "steps": [
        {
          "id": "bp_1",
          "screenId": "product_list",
          "next": [
            {
              "targetStepId": "bp_2"
            }
          ]
        },
        {
          "id": "bp_2",
          "screenId": "product_detail"
        }
      ]
    }
  ],
  "jtbd": {
    "admin": [
      "Create user",
      "Review users",
      "Review products"
    ],
    "viewer": [
      "Browse products",
      "See product detail"
    ]
  },
  "roles": [
    {
      "id": "admin",
      "name": "Admin"
    },
    {
      "id": "viewer",
      "name": "Viewer"
    }
  ]
}
